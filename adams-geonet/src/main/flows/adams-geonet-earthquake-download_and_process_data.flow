# Project: adams
# Date: 2014-02-21 00:26:58
# User: fracpete
#
adams.flow.control.Flow
	-annotation
	Local time: 2012-02-07 13:23\nRegion: Canterbury\nRichter Magnitude: 3.0\nhttp://www.geonet.org.nz/earthquake/quakes/3654793g.html
	-actor
		adams.flow.standalone.CallableActors
			-actor
				adams.flow.sink.SequencePlotter
					-writer
						adams.gui.print.NullWriter
					-paintlet
						adams.gui.visualization.sequence.PaintletWithFixedYRange
							-min-y
							-50000.0
							-max-y
							50000.0
							-paintlet
								adams.gui.visualization.sequence.LinePaintlet
									-stroke-thickness
									1.5
									-markers-disabled
									true
									-paint-all
									true
					-overlay-paintlet
						adams.gui.visualization.sequence.CirclePaintlet
					-marker-paintlet
						adams.flow.sink.sequenceplotter.NoMarkers
					-error-paintlet
						adams.flow.sink.sequenceplotter.NoErrorPaintlet
					-color-provider
						adams.gui.visualization.core.CustomColorProvider
							-color
							#0000ff
							-color
							#ff0000
							-color
							#990099
					-overlay-color-provider
						adams.gui.visualization.core.DefaultColorProvider
					-title
					GeoNet: earthquake data
					-axis-x
						adams.gui.visualization.core.AxisPanelOptions
							-label
							timestamp
							-type
							DATETIME
							-tick-generator
								adams.gui.visualization.core.axis.FancyTickGenerator
							-width
							40
							-custom-format
							M/d HH:mm:ss
					-axis-y
						adams.gui.visualization.core.AxisPanelOptions
							-label
							amplitude
							-tick-generator
								adams.gui.visualization.core.axis.FancyTickGenerator
							-width
							80
							-custom-format
							0.0
					-plot-updater
						adams.flow.sink.sequenceplotter.SimplePlotUpdater
							-update-interval
							200
					-post-processor
						adams.flow.sink.sequenceplotter.AligningSequences
							-limit
							2000
			-actor
				adams.flow.sink.Display
	-actor
		adams.flow.standalone.SetVariable
			-name
			start time (UTC)
			-var-name
			time
			-var-value
			2012/02/07 00:20:00
	-actor
		adams.flow.standalone.SetVariable
			-name
			# of seconds
			-var-name
			seconds
			-var-value
			300
	-actor
		adams.flow.standalone.SetVariable
			-name
			station
			-var-name
			station
			-var-value
			NZCRL
	-actor
		adams.flow.source.ForLoop
			-upper
			2
	-actor
		adams.flow.control.Trigger
			-name
			assemble input filename (north)
			-tee
				adams.flow.source.StringConstants
					-string
					${CWD}
			-tee
				adams.flow.transformer.AppendName
					-suffix
					@{station}
			-tee
				adams.flow.transformer.AppendName
					-name
					AppendName-1
					-suffix
					Z_HHN10.txt
					-no-separator
					true
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					input_north
	-actor
		adams.flow.control.Trigger
			-name
			assemble input filename (east)
			-tee
				adams.flow.source.StringConstants
					-string
					${CWD}
			-tee
				adams.flow.transformer.AppendName
					-suffix
					@{station}
			-tee
				adams.flow.transformer.AppendName
					-name
					AppendName-1
					-suffix
					Z_HHE10.txt
					-no-separator
					true
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					input_east
	-actor
		adams.flow.control.Trigger
			-name
			assemble input filename (vertical)
			-tee
				adams.flow.source.StringConstants
					-string
					${CWD}
			-tee
				adams.flow.transformer.AppendName
					-suffix
					@{station}
			-tee
				adams.flow.transformer.AppendName
					-name
					AppendName-1
					-suffix
					Z_HHZ10.txt
					-no-separator
					true
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					input_vertical
	-actor
		adams.flow.control.Trigger
			-name
			assemble cmdline
			-tee
				adams.flow.source.Variable
					-var-name
					time
			-tee
				adams.flow.transformer.StringReplace
					-find
					.*
					-replace
					@{system.java.home}/bin/java -cp @{system.java.class.path} gov.usgs.anss.query.EdgeQueryClient -t text -s @{station} -d @{seconds} -b \"@{time}\"
					-variable
					true
			-tee
				adams.flow.transformer.SetVariable
					-name
					SetVariable-1
					-var-name
					cmdline
			-tee
				adams.flow.sink.CallableSink
					-callable
					Display
	-actor
		adams.flow.control.Trigger
			-name
			increment time
			-tee
				adams.flow.source.Variable
					-var-name
					time
			-tee
				adams.flow.transformer.Convert
					-conversion
						adams.data.conversion.TimestampToDouble
							-format
							yyyy/MM/dd HH:mm:ss
			-tee
				adams.flow.transformer.MathExpression
					-expression
					X+@{seconds}*1000
			-tee
				adams.flow.transformer.Convert
					-name
					Convert-1
					-conversion
						adams.data.conversion.TimeToString
							-format
							yyyy/MM/dd HH:mm:ss
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					time
	-actor
		adams.flow.control.Trigger
			-name
			run cmd
			-tee
				adams.flow.source.Exec
					-cmd
					@{cmdline}
					-stderr
					true
					-conversion
						adams.data.conversion.StringToString
			-tee
				adams.flow.sink.CallableSink
					-callable
					Display
	-actor
		adams.flow.control.Tee
			-name
			process data
			-tee
				adams.flow.control.Branch
					-branch
						adams.flow.control.Trigger
							-name
							process data (north)
							-tee
								adams.flow.source.Variable
									-var-name
									input_north
							-tee
								adams.flow.transformer.TextFileReader
									-reader
										adams.data.io.input.LineByLineTextReader
							-tee
								adams.flow.control.Tee
									-name
									extract data
									-tee
										adams.flow.control.Branch
											-branch
												adams.flow.control.Sequence
													-name
													timestamp
													-actor
														adams.flow.transformer.StringCut
															-field-delimiter
															 
													-actor
														adams.flow.transformer.Convert
															-conversion
																adams.data.conversion.StringToDouble
													-actor
														adams.flow.transformer.SetVariable
															-var-name
															timestamp
											-branch
												adams.flow.control.Sequence
													-name
													amplitude
													-actor
														adams.flow.transformer.StringCut
															-field-delimiter
															 
															-field-index
															2
													-actor
														adams.flow.transformer.Convert
															-conversion
																adams.data.conversion.StringToDouble
													-actor
														adams.flow.transformer.SetVariable
															-var-name
															amplitude
							-tee
								adams.flow.control.Trigger
									-name
									create plot data
									-tee
										adams.flow.source.Variable
											-var-name
											amplitude
									-tee
										adams.flow.control.Injector
											-injection
											@{timestamp}
											-location
											BEFORE
									-tee
										adams.flow.transformer.Convert
											-conversion
												adams.data.conversion.StringToDouble
									-tee
										adams.flow.transformer.SequenceToArray
											-length
											2
									-tee
										adams.flow.transformer.MakePlotContainer
											-plot-name
											north
									-tee
										adams.flow.sink.CallableSink
											-callable
											SequencePlotter
					-branch
						adams.flow.control.Trigger
							-name
							process data (east)
							-tee
								adams.flow.source.Variable
									-var-name
									input_east
							-tee
								adams.flow.transformer.TextFileReader
									-reader
										adams.data.io.input.LineByLineTextReader
							-tee
								adams.flow.control.Tee
									-name
									extract data
									-tee
										adams.flow.control.Branch
											-branch
												adams.flow.control.Sequence
													-name
													timestamp
													-actor
														adams.flow.transformer.StringCut
															-field-delimiter
															 
													-actor
														adams.flow.transformer.Convert
															-conversion
																adams.data.conversion.StringToDouble
													-actor
														adams.flow.transformer.SetVariable
															-var-name
															timestamp
											-branch
												adams.flow.control.Sequence
													-name
													amplitude
													-actor
														adams.flow.transformer.StringCut
															-field-delimiter
															 
															-field-index
															2
													-actor
														adams.flow.transformer.Convert
															-conversion
																adams.data.conversion.StringToDouble
													-actor
														adams.flow.transformer.SetVariable
															-var-name
															amplitude
							-tee
								adams.flow.control.Trigger
									-name
									create plot data
									-tee
										adams.flow.source.Variable
											-var-name
											amplitude
									-tee
										adams.flow.control.Injector
											-injection
											@{timestamp}
											-location
											BEFORE
									-tee
										adams.flow.transformer.Convert
											-conversion
												adams.data.conversion.StringToDouble
									-tee
										adams.flow.transformer.SequenceToArray
											-length
											2
									-tee
										adams.flow.transformer.MakePlotContainer
											-plot-name
											east
									-tee
										adams.flow.sink.CallableSink
											-callable
											SequencePlotter
					-branch
						adams.flow.control.Trigger
							-name
							process data (vertical)
							-tee
								adams.flow.source.Variable
									-var-name
									input_vertical
							-tee
								adams.flow.transformer.TextFileReader
									-reader
										adams.data.io.input.LineByLineTextReader
							-tee
								adams.flow.control.Tee
									-name
									extract data
									-tee
										adams.flow.control.Branch
											-branch
												adams.flow.control.Sequence
													-name
													timestamp
													-actor
														adams.flow.transformer.StringCut
															-field-delimiter
															 
													-actor
														adams.flow.transformer.Convert
															-conversion
																adams.data.conversion.StringToDouble
													-actor
														adams.flow.transformer.SetVariable
															-var-name
															timestamp
											-branch
												adams.flow.control.Sequence
													-name
													amplitude
													-actor
														adams.flow.transformer.StringCut
															-field-delimiter
															 
															-field-index
															2
													-actor
														adams.flow.transformer.Convert
															-conversion
																adams.data.conversion.StringToDouble
													-actor
														adams.flow.transformer.SetVariable
															-var-name
															amplitude
							-tee
								adams.flow.control.Trigger
									-name
									create plot data
									-tee
										adams.flow.source.Variable
											-var-name
											amplitude
									-tee
										adams.flow.control.Injector
											-injection
											@{timestamp}
											-location
											BEFORE
									-tee
										adams.flow.transformer.Convert
											-conversion
												adams.data.conversion.StringToDouble
									-tee
										adams.flow.transformer.SequenceToArray
											-length
											2
									-tee
										adams.flow.transformer.MakePlotContainer
											-plot-name
											vertical
									-tee
										adams.flow.sink.CallableSink
											-callable
											SequencePlotter
					-num-threads
					3
	-actor
		adams.flow.control.Trigger
			-name
			clean up
			-tee
				adams.flow.standalone.DeleteFile
					-regexp
					.*\\.txt
	-error-handling
	ACTORS_DECIDE_TO_STOP_ON_ERROR
	-flow-execution-listener
		adams.flow.execution.NullListener

